<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ë°€í¬í‹° VOC ê°ì§€ ë° ìƒë‹´ìœ í˜• ì¶”ì²œ ì‹œìŠ¤í…œ</title>
    <link rel="manifest" href="manifest.json">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap');

        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #f4f6f8;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .container {
            width: 90%;
            max-width: 1200px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            min-height: 95vh;
        }
        header {
            background: linear-gradient(135deg, #003366, #00509e);
            color: white;
            padding: 20px;
            font-size: 2em;
            font-weight: bold;
            border-radius: 0 0 12px 12px;
            text-align: center;
        }
        .main-content {
            display: flex;
            flex: 1;
            padding: 20px;
            gap: 20px;
            min-height: 0;
        }
        .left-panel, .right-panel {
            display: flex;
            flex-direction: column;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            background: #fdfdfd;
        }
        .left-panel {
            flex: 2;
        }
        .right-panel {
            flex: 1;
            background-color: #f9f9f9;
        }
        .notice {
            background-color: #f9fafb;
            border-left: 5px solid #00509e;
            padding: 15px 20px;
            margin-bottom: 20px;
            font-size: 0.95em;
            line-height: 1.6;
        }
        .panel-title {
            font-size: 1.2em;
            font-weight: bold;
            color: #000;
            margin-bottom: 15px;
            border-bottom: 2px solid #0056b3;
            padding-bottom: 5px;
        }
        .input-area {
            flex: 1;
            width: 100%;
            min-height: 150px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 0.95em;
            border: 1px solid #ccc;
            border-radius: 8px;
            background: white;
            outline: none;
            overflow-y: auto;
            white-space: pre-wrap;
            word-break: break-word;
            transition: border-color 0.3s;
        }
        .result-box {
            margin-top: 10px;
            padding: 10px;
            border-left: 5px solid;
            display: none;
            font-weight: bold;
        }
        .result-box.complaint {
            color: #c0392b;
            background-color: #fff0f0;
            border-color: #c0392b;
        }
        .result-box.normal {
            color: #2e7d32;
            background-color: #e6f4ea;
            border-color: #2e7d32;
        }
        .keywords-box {
            margin-top: 10px;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #ddd;
            display: none;
            flex-direction: column;
            box-sizing: border-box;
        }
        .keywords-title {
            font-size: 1em;
            font-weight: bold;
            color: #000;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
        }
        .keywords-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        .keyword {
            background-color: rgba(255, 0, 0, 0.1);
            color: red;
            padding: 4px 8px;
            border: none;
            border-radius: 5px;
            font-size: 0.9em;
            font-weight: normal;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .keyword:hover {
            background-color: rgba(255, 0, 0, 0.2);
        }
        .keyword-desc {
            margin-top: 10px;
            padding: 10px;
            background: #e0e0e0;
            border-radius: 5px;
            font-size: 0.9em;
            display: none;
        }
        
        .recommendation-list {
            margin-top: 15px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .recommendation-item {
            display: flex;
            align-items: flex-start;
            padding: 4px 8px;
            margin: 4px;
            background-color: #eaf3fd;
            border: 1px solid #cce5ff;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            transition: all 0.2s ease-in-out;
        }
        .recommendation-item-line {
            width: 5px;
            height: 100%;
            background-color: #0056b3;
            border-radius: 2px;
            margin-right: 15px;
        }
        .recommendation-item-content {
            flex-grow: 1;
        }
        .recommendation-title {
            font-size: 1em;
            font-weight: bold;
            color: #000;
            margin-bottom: 5px;
        }
        .match-info {
            font-size: 0.9em;
            color: #555;
            line-height: 1.4;
        }
        .match-info strong {
            color: #0056b3;
        }
        
        .security-banner {
            background-color: #003366;
            color: white;
            padding: 10px 20px;
            font-size: 0.9em;
            font-weight: bold;
            text-align: center;
            border-radius: 0 0 12px 12px;
            margin: 0 20px 20px 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            position: relative;
            left: 0;
            right: 0;
            bottom: 0;
            width: calc(100% - 40px);
            box-sizing: border-box;
        }
        .container > .security-banner {
            border-radius: 0 0 12px 12px;
            margin-bottom: 0;
        }

        .initial-message {
            text-align: center;
            color: #777;
            font-size: 0.9em;
            padding-top: 20px;
        }
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            .security-banner {
                margin: 0 20px 20px 20px;
                width: calc(100% - 40px);
            }
        }
        [data-placeholder]:empty:before {
            content: attr(data-placeholder);
            color: #aaa;
        }

        /* --- ì¶”ê°€ëœ PWA ì„¤ì¹˜ íŒì—… ìŠ¤íƒ€ì¼ --- */
        #installPopup {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border: 2px solid #00509e;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            z-index: 9999;
            text-align: center;
        }
        #installPopup button {
            margin: 5px;
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }
        #confirmInstall {
            background: #00509e;
            color: white;
        }
        #cancelInstall {
            background: #ccc;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>ë°€í¬í‹° VOC ê°ì§€ ë° ìƒë‹´ìœ í˜• ì¶”ì²œ ì‹œìŠ¤í…œ</header>
        <div class="main-content">
            <div class="left-panel">
                <div class="notice">
                    ìƒë‹´ ë‚´ìš©ì„ ì…ë ¥í•˜ë©´, ë¶ˆë§Œìœ¼ë¡œ ì˜ì‹¬ë˜ëŠ” í‘œí˜„ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ê°ì§€í•˜ì—¬ ê²°ê³¼ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.<br>
                    í•´ë‹¹ ê²°ê³¼ë¥¼ ì°¸ê³ í•˜ì—¬ <strong>VOC êµ¬ë¶„ ì…ë ¥</strong>ì„ í•©ë‹ˆë‹¤.<br>
                    <strong>ì´ ê²°ê³¼ëŠ” ì°¸ê³ ìš©ì´ë©°, ìµœì¢… íŒë‹¨ì€ ìƒë‹´ì‚¬ê°€ ì§ì ‘ í•´ì•¼í•©ë‹ˆë‹¤.</strong>
                </div>
                <div id="inputArea" class="input-area" contenteditable="true" spellcheck="false" placeholder="ìƒë‹´ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”."></div>
            </div>

            <div class="right-panel">
                <div class="panel-title">ìƒë‹´ ìœ í˜• ì¶”ì²œ</div>
                <div id="recommendationList" class="recommendation-list">
                    <div class="initial-message">ë‚´ìš©ì„ ì…ë ¥í•˜ë©´<br>ì¶”ì²œ ìœ í˜•ì´ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.</div>
                </div>

                <div class="panel-title" style="margin-top: 20px;">ë¶ˆë§Œ ê°ì§€ ë° í‚¤ì›Œë“œ</div>
                <div id="resultBox" class="result-box"></div>
                <div id="keywordsBox" class="keywords-box">
                    <div id="keywordsTitle" class="keywords-title"></div>
                    <div id="keywordList" class="keywords-list"></div>
                    <div id="keywordDesc" class="keyword-desc"></div>
                </div>
            </div>
        </div>
        
        <div id="securityBanner" class="security-banner">
            ğŸ”’ ë³´ì•ˆ ìƒíƒœ: ì•ˆì „ â€” ì™¸ë¶€ ì „ì†¡ ì—†ìŒ
        </div>
    </div>

    <div id="installPopup">
        <p style="font-size:1.1em; margin-bottom:15px;">ğŸ“² ì´ ì•±ì„ ì„¤ì¹˜í•˜ì‹œê² ìŠµë‹ˆê¹Œ?</p>
        <button id="confirmInstall">ì„¤ì¹˜</button>
        <button id="cancelInstall">ì·¨ì†Œ</button>
    </div>

    <script>
        const inputArea = document.getElementById('inputArea');
        const resultBox = document.getElementById('resultBox');
        const recommendationList = document.getElementById('recommendationList');
        const initialMessage = document.querySelector('.initial-message');
        const keywordsBox = document.getElementById('keywordsBox');
        const keywordsTitle = document.getElementById('keywordsTitle');
        const keywordList = document.getElementById('keywordList');
        const keywordDescBox = document.getElementById('keywordDesc');
        const securityBanner = document.getElementById('securityBanner');

        const complaintKeywords = [
            "ë¶ˆë§Œ", "ë¶ˆì¾Œ", "í•­ì˜", "ì§œì¦", "ì‹¤ë§", "ë¶ˆì¹œì ˆ", "ê¸°ë¶„ ë‚˜ë¹´", "ì–¸ì§¢", "ë¬´ë¡€", "ë¶€ë‹¹",
            "ê¸°ë¶„ ìƒí–ˆ", "ê°•ì„±", "ì‹ ê³ ", "ê²½ì°°", "ì†Œë³´ì›", "ì†Œë¹„ìë³´í˜¸ì›", "ì†Œë¹„ì ë³´í˜¸ì›",
            "ìš•ì„¤", "ìµœì•…", "ë²•ì ëŒ€ì‘"
        ];
        const keywordDescriptions = {
            "ë¶ˆë§Œ": "ì„œë¹„ìŠ¤ë‚˜ ì œí’ˆì— ëŒ€í•œ ì „ë°˜ì ì¸ ë¶ˆë§Œ í‘œí˜„ì…ë‹ˆë‹¤.",
            "ë¶ˆì¾Œ": "ê³ ê°ì´ ê¸°ë¶„ì´ ìƒí•˜ê±°ë‚˜ ë¶ˆì¾Œê°ì„ ëŠë‚€ ìƒí™©ì…ë‹ˆë‹¤.",
            "í•­ì˜": "ë¬¸ì œ ì œê¸°ì™€ í•¨ê»˜ ì‹œì • ìš”êµ¬ ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤.",
            "ì§œì¦": "ë¶ˆí¸Â·ë¶ˆë§Œì´ ê°ì •ì ìœ¼ë¡œ í‘œì¶œëœ ìƒíƒœì…ë‹ˆë‹¤.",
            "ì‹¤ë§": "ê¸°ëŒ€ì— ë¯¸ì¹˜ì§€ ëª»í•´ ë¶€ì •ì  í‰ê°€ë¥¼ í•˜ëŠ” ê²½ìš°ì…ë‹ˆë‹¤.",
            "ë¶ˆì¹œì ˆ": "ì‘ëŒ€ íƒœë„ë‚˜ ì„œë¹„ìŠ¤ ë§¤ë„ˆì— ëŒ€í•œ ë¶€ì •ì  í”¼ë“œë°±ì…ë‹ˆë‹¤.",
            "ê¸°ë¶„ ë‚˜ë¹´": "ë°œì–¸Â·í–‰ë™ìœ¼ë¡œ ì¸í•´ ê°ì •ì´ ìƒí•œ ìƒíƒœì…ë‹ˆë‹¤.",
            "ì–¸ì§¢": "ì‚¬ì†Œí•´ ë³´ì´ì§€ë§Œ ë¶ˆë§Œìœ¼ë¡œ ë²ˆì§ˆ ìˆ˜ ìˆëŠ” ê°ì • í‘œí˜„ì…ë‹ˆë‹¤.",
            "ë¬´ë¡€": "ì˜ˆì˜ ì—†ëŠ” íƒœë„ë‚˜ ë°œì–¸ì— ëŒ€í•œ ì§€ì ì…ë‹ˆë‹¤.",
            "ë¶€ë‹¹": "ë¶ˆê³µì •Â·ë¶€ì •í™•í•œ ì²˜ë¦¬ì— ëŒ€í•œ ë¬¸ì œ ì œê¸°ì…ë‹ˆë‹¤.",
            "ê¸°ë¶„ ìƒí–ˆ": "ê³ ê° ê°ì •ì´ í¬ê²Œ ìƒí•œ ìƒíƒœë¡œ, ì§„ì •ì´ í•„ìš”í•©ë‹ˆë‹¤.",
            "ê°•ì„±": "ê°•ê²½í•œ ì–´ì¡°ë¡œ ë¶ˆë§Œì„ ì œê¸°í•˜ëŠ” ê²½ìš°ì…ë‹ˆë‹¤.",
            "ì‹ ê³ ": "ì™¸ë¶€ ê¸°ê´€ì— ë¬¸ì œë¥¼ ì•Œë¦¬ê² ë‹¤ëŠ” ì˜ì‚¬ í‘œí˜„ì…ë‹ˆë‹¤.",
            "ê²½ì°°": "ë²•ì Â·í˜•ì‚¬ì  ì¡°ì¹˜ë¥¼ ì•”ì‹œí•˜ëŠ” ë°œì–¸ì…ë‹ˆë‹¤.",
            "ì†Œë³´ì›": "ì†Œë¹„ìë³´í˜¸ì›ì— ì‹ ê³  ì˜ì‚¬ë¥¼ ë°íˆëŠ” ê²½ìš°ì…ë‹ˆë‹¤.",
            "ì†Œë¹„ìë³´í˜¸ì›": "ì†Œë¹„ìë³´í˜¸ì›ì— ì‹ ê³  ì˜ì‚¬ë¥¼ ë°íˆëŠ” ê²½ìš°ì…ë‹ˆë‹¤.",
            "ì†Œë¹„ì ë³´í˜¸ì›": "ì†Œë¹„ìë³´í˜¸ì›ì— ì‹ ê³  ì˜ì‚¬ë¥¼ ë°íˆëŠ” ê²½ìš°ì…ë‹ˆë‹¤.",
            "ìš•ì„¤": "ë¶€ì ì ˆí•œ ì–¸ì–´ ì‚¬ìš©ìœ¼ë¡œ ê°ì •ì´ ê²©í•´ì§„ ìƒíƒœì…ë‹ˆë‹¤.",
            "ìµœì•…": "ë§¤ìš° ê°•í•œ ë¶€ì • í‰ê°€ë¡œ, ë¶ˆë§Œ ê°•ë„ê°€ ë†’ìŠµë‹ˆë‹¤.",
            "ë²•ì ëŒ€ì‘": "ë²•ì  ì ˆì°¨ë¥¼ ì§„í–‰í•˜ê² ë‹¤ëŠ” ì˜ì‚¬ í‘œí˜„ì…ë‹ˆë‹¤."
        };

        const ìƒë‹´ìœ í˜•ë°ì´í„° = `ìƒë‹´ìœ í˜•(ëŒ€),ìƒë‹´ìœ í˜•(ì¤‘),í‚¤ì›Œë“œ1,í‚¤ì›Œë“œ2,í‚¤ì›Œë“œ3,í‚¤ì›Œë“œ4,í‚¤ì›Œë“œ5,í‚¤ì›Œë“œ6,í‚¤ì›Œë“œ7,í‚¤ì›Œë“œ8,í‚¤ì›Œë“œ9,í‚¤ì›Œë“œ10
êµì‚¬ê´€ë ¨,ê´€ë¦¬êµì‚¬,êµì‚¬,ì„ ìƒ,ê´€ë¦¬,,,,,,,
êµì‚¬ê´€ë ¨,ìƒë‹´êµì‚¬,êµì‚¬,ì„ ìƒ,ìƒë‹´,,,,,,,
êµì‚¬ê´€ë ¨,ì§€ì‚¬(í™ë³´)êµì‚¬,êµì‚¬,ì„ ìƒ,ì§€ì‚¬,í™ë³´,,,,,
ì›ê²©ìš”ì²­,êµ¬ì„±í’ˆ,ì›ê²©,êµ¬ì„±í’ˆ,í‚¤ë³´ë“œ,íœ,,,,,
ì›ê²©ìš”ì²­,í•™ìŠµê¸°ê¸°,ì›ê²©,ê¸°ê¸°,,,,,,,,
ì›ê²©ìš”ì²­,í•™ìŠµí™˜ê²½,ì›ê²©,í™˜ê²½,ì™€ì´íŒŒì´,WIFI,,,,,
ì›ê²©ìš”ì²­,ì˜ˆì•½í™•ì¸/ë³€ê²½/ì·¨ì†Œ,ì›ê²©,ì˜ˆì•½,í™•ì¸,ë³€ê²½,ì·¨ì†Œ,,,,
ì›ê²©ìš”ì²­,í”„ë¦¬íŒ¨ìŠ¤ì›ê²©,ì›ê²©,í”„ë¦¬íŒ¨ìŠ¤,,,,,,,,
ê²°ì œê´€ë ¨,ê²°ì œìš”ì²­ë°ë³€ê²½,ê²°ì œ,ìš”ì²­,ë³€ê²½,ì¦‰ì‹œ,ê³„ì¢Œ,,,,,
ê²°ì œê´€ë ¨,ê²°ì œí™•ì¸,ê²°ì œ,í™•ì¸,ë¬¸ì˜,ì¦ëª…,,,,,,
ê²°ì œê´€ë ¨,ê²°ì œì˜¤ë¥˜,ê²°ì œ,ì˜¤ë¥˜,ì´ì¤‘ê²°ì œ,,,,,,,
ê¸°ê¸°ì‚¬ìš©ê´€ë ¨,WIFIë°ì„¤ì¹˜,ê¸°ê¸°,WIFI,ì™€ì´íŒŒì´,ê³µìœ ê¸°,í•«ìŠ¤íŒŸ,,,,
ê¸°ê¸°ì‚¬ìš©ê´€ë ¨,êµ¬ì„±í’ˆê´€ë ¨,ê¸°ê¸°,êµ¬ì„±í’ˆ,í‚¤ë³´ë“œ,íœ,,,,,
ê¸°ê¸°ì‚¬ìš©ê´€ë ¨,ê¸°ê¸°ì¸ì¦ì´ˆê¸°í™”,ê¸°ê¸°,ì¸ì¦,ë¡œê·¸ì¸,ì´ˆê¸°í™”,,,,,
ê¸°ê¸°ì‚¬ìš©ê´€_í•™ìŠµê¸°ê¸°ê´€ë ¨,ê¸°ê¸°,ë¬¸ì˜,ì—…ë°ì´íŠ¸,ìµœì í™”,,,,,
ê¸°ê¸°ì‚¬ìš©ê´€ë ¨,ê³µì¥ì´ˆê¸°í™”,ê¸°ê¸°,ê³µì¥ì´ˆê¸°í™”,ê¸°ê¸°ì´ˆê¸°í™”,ì´ˆê¸°í™”,,,,,
ASê´€ë ¨,ASëŒ€í–‰ë°ë°œì†¡,AS,ëŒ€í–‰,ëŒ€ì²´ê¸°ê¸°,íšŒìˆ˜,,,,,
ASê´€ë ¨,êµ¬ì„±í’ˆAS,AS,êµ¬ì„±í’ˆ,í‚¤ë³´ë“œ,íœ,,,,,
ASê´€ë ¨,ASê´€ë ¨ì·¨ì†Œ,AS,ëŒ€í–‰,ì·¨ì†Œ,,,,,,
ASê´€ë ¨,ë¶ˆëŸ‰íŒì •ì„œê¸°ê¸°êµì²´,AS,ë¶ˆëŸ‰,íŒì •ì„œ,íŒ©ìŠ¤,,,,,
ASê´€ë ¨,ì‚¼ì„±ASì„¼í„°ê´€ë ¨,AS,ì‚¼ì„±,í™•ì¸ì„œ,,,,,,
ASê´€ë ¨,ê¸°ê¸°ASê´€ë ¨,AS,ê¸°ê¸°,ì ê²€,,,,,,
ê°œì¸ì •ë³´ê´€ë ¨,ID/ë¹„ë²ˆë¬¸ì˜,ê°œì¸ì •ë³´,ID,ì•„ì´ë””,ë¹„ë²ˆ,ë¹„ë°€ë²ˆí˜¸,ì•”í˜¸,íŒ¨ìŠ¤ì›Œë“œ,,
ê°œì¸ì •ë³´ê´€ë ¨,ì •ë³´í™•ì¸ë°ë³€ê²½,ê°œì¸ì •ë³´,í™•ì¸,ë³€ê²½,ì£¼ì†Œ,ì—°ë½ì²˜,ë²ˆí˜¸,,,
ê°œì¸ì •ë³´ê´€ë ¨,ê³„ì •ìƒì„±ê´€ë ¨,ê°œì¸ì •ë³´,ê³„ì •,ìƒì„±,ì•„ì´ë””,ID,ë¡œê·¸ì¸,,,
ê°œì¸ì •ë³´ê´€ë ¨,íƒˆí‡´ë¬¸ì˜,ê°œì¸ì •ë³´,íƒˆí‡´,ì‚­ì œ,,,,,,
ê°œì¸ì •ë³´ê´€ë ¨,ë™ì˜ì •ë³´/ìˆ˜ì‹ ê±°ë¶€,ê°œì¸ì •ë³´,ë™ì˜,ê±°ë¶€,ì‚­ì œ,íƒˆí‡´,ë§ˆì¼€íŒ…,,,
ì¥ì• ê´€ë ¨,ì¥ì• ì¬ì¸ì…,ì¥ì• ,ì˜¤ë¥˜,ì¬ì¸ì…,,,,,
ì¥ì• ê´€ë ¨,ì„œë²„ì¥ì• ,ì¥ì• ,ì˜¤ë¥˜,ì„œë²„,,,,,
ì¥ì• ê´€ë ¨,ëŸ°ì²˜ì¥ì• ,ì¥ì• ,ì˜¤ë¥˜,ëŸ°ì²˜,,,,,
ì¥ì• ê´€ë ¨,ê¸°íƒ€ì„œë¹„ìŠ¤ì¥ì• ,ì¥ì• ,ì˜¤ë¥˜,ì„œë¹„ìŠ¤,,,,,
ì¥ì• ê´€ë ¨,íƒ€í•™êµê¸‰ì¥ì• ,ì¥ì• ,ì˜¤ë¥˜,íƒ€í•™êµ,,,,,
ì´ë²¤íŠ¸ê´€ë ¨,í•™ìŠµì´ë²¤íŠ¸,ì´ë²¤íŠ¸,í•™ìŠµ,ì„¤ëª…íšŒ,,,,,
ì´ë²¤íŠ¸ê´€ë ¨,ê°€ì…ë°ì²´í—˜ì´ë²¤íŠ¸,ì´ë²¤íŠ¸,ê°€ì…,ì²´í—˜,ìƒí’ˆê¶Œ,í˜œíƒ,,,,
ì´ë²¤íŠ¸ê´€ë ¨,ì¹œêµ¬ì¶”ì²œ,ì´ë²¤íŠ¸,ì¹œêµ¬,ì§€ì¸,ì¶”ì²œ,ìƒí’ˆê¶Œ,,,,
ê¸°íƒ€,ê¸°ë¬¸ì˜OUTì½œ,OUT,ì•„ì›ƒ,,,,,,
ê¸°íƒ€,íƒ€í•™êµê¸‰ì¸ì…,íƒ€í•™êµ,ì•„ì´,ì´ˆë“±,ì¤‘ê³ ë“±,ì¸ì…,,,,
ê¸°íƒ€,ê·¸ë£¹ì‚¬ì„œë¹„ìŠ¤,ê·¸ë£¹ì‚¬,êµê³¼ì„œ,,,,,,
ê¸°íƒ€,ë§ˆì¼€íŒ…/ì œíœ´/í™ë³´,ì œíœ´,ë§ˆì¼€íŒ…,í™ë³´,ê´‘ê³ ,,,,,
ê¸°íƒ€,ë‹¨ì„ /ì˜¤ì¸ì…/ì—°ë½ìš”ì²­,ë‹¨ì„ ,ì˜¤ì¸ì…,ì—°ë½ìš”ì²­,ë¯¸í™•ì¸,,,,
ê¸°íƒ€,íƒ€ë¶€ì„œì—…ë¬´ë¬¸ì˜,íƒ€ë¶€ì„œ,ê³µëª¨ì „,,,,,,
ê¸°íƒ€,ìƒë‹´ì˜¤ë“±ë¡,ì˜¤ë“±ë¡,ìƒë‹´,,,,,,
ê¸°íƒ€,ì´ì „ìƒë‹´ì‚¬ì´ê´€,ì´ì „ìƒë‹´ì‚¬,ìƒë‹´ì‚¬,ìš”ì²­,ì „ë‹¬,,,,
ê¸°íƒ€,ê³ ê°ì„¼í„°ê´€ë ¨,ê³ ê°ì„¼í„°,,,,,,,,
ê¸°íƒ€,(ì›ê²©)ë¶€ì¬,ì›ê²©,ë¶€ì¬,,,,,,
ê¸°íƒ€,(ì›ê²©)ì›ê²©ì¤‘,ì›ê²©,ì›ê²©ì¤‘,,,,,,
ê¸°íƒ€,ë°€í¬Tì•„ì´(ëŸ°ì²˜),ëŸ°ì²˜,ë°€í¬Tì•„ì´,,,,,,
ê¸°íƒ€,ì‘ëŒ€ë¶ˆê°€(ìš•ì„¤),ì‘ëŒ€ë¶ˆê°€,ìš•ì„¤,,,,,,
í™”ìƒì½”ì¹˜,ì‹œê°„ë¬¸ì˜ë°ë³€ê²½,í™”ìƒ,ë§ì¶¤í†¡ìŒ¤,ì‹œê°„,ë¬¸ì˜,,,,
í™”ìƒì½”ì¹˜,ì…ì¥ë°©ë²•ë°ì˜¤ë¥˜,í™”ìƒ,ì´ˆëŒ€,,,,,,
í™”ìƒì½”ì¹˜,ì°¸ì—¬ë¶ˆê°€,í™”ìƒ,ì°¸ì—¬,ë¶ˆê°€,ë¬´ê´€ë¦¬,,,,
ë°°ì†¡ê´€ë ¨,ê¸°ê¸°ë°êµ¬ì„±í’ˆë°°ì†¡,ë°°ì†¡,ê¸°ê¸°,ì²´í—˜ê¸°ê¸°,,,,,
ë°°ì†¡ê´€ë ¨,ì „ìš©êµì¬ë°°ì†¡,ë°°ì†¡,êµì¬,ì „ìš©êµì¬,,,,,
ë°°ì†¡ê´€ë ¨,íŒì´‰ë¬¼ë°°ì†¡,ë°°ì†¡,íŒì´‰ë¬¼,ì‚¬ì€í’ˆ,,,,,
ë°°ì†¡ê´€ë ¨,ì´ë²¤íŠ¸ìƒí’ˆë°°ì†¡,ë°°ì†¡,ì´ë²¤íŠ¸,ì¹´ë©”ë¼,ìƒí’ˆ,,,,
íšŒìˆ˜ê´€ë ¨,íšŒìˆ˜ìš”ì²­,íšŒìˆ˜,ì²´í—˜ê¸°ê¸°,ê¸°ê¸°,,,,,
íšŒìˆ˜ê´€ë ¨,íšŒìˆ˜ì¤‘ë³µë°ì§€ì—°,íšŒìˆ˜,ì¤‘ë³µ,ì§€ì—°,,,,,
íšŒìˆ˜ê´€ë ¨,íšŒìˆ˜ì¼ë°˜ë¬¸ì˜,íšŒìˆ˜,ë¬¸ì˜,,,,,,
íšŒìˆ˜ê´€ë ¨,íšŒìˆ˜ì •ë³´ë³€ê²½,íšŒìˆ˜,íšŒìˆ˜ì§€,ì£¼ì†Œì§€,ì£¼ì†Œ,ë²ˆí˜¸,,,,
ì·¨ì†Œ/í™˜ë¶ˆê´€ë ¨,ë¬¸ì˜-ì²˜ë¦¬ì§„í–‰ìƒí™©,í•´ì§€,ì·¨ì†Œ,í™˜ë¶ˆ,ë¬¸ì˜,ì²˜ë¦¬,ìƒí™©,,,
ì·¨ì†Œ/í™˜ë¶ˆê´€ë ¨,ë¬¸ì˜-í•™ìŠµê±°ë¶€/ì‹œê°„ë¶€ì¡±,í•´ì§€,ì·¨ì†Œ,í™˜ë¶ˆ,ë¬¸ì˜,ì‹œê°„,,,,
ì·¨ì†Œ/í™˜ë¶ˆê´€ë ¨,ë¬¸ì˜-ê°œì¸ì‚¬ì •,í•´ì§€,ì·¨ì†Œ,í™˜ë¶ˆ,ë¬¸ì˜,ì‚¬ì •,,,,
ì·¨ì†Œ/í™˜ë¶ˆê´€ë ¨,ë¬¸ì˜-í•™ìŠµë³€ê²½(ì˜¨ë¼ì¸),í•´ì§€,ì·¨ì†Œ,í™˜ë¶ˆ,ë¬¸ì˜,ë³€ê²½,,,,
ì·¨ì†Œ/í™˜ë¶ˆê´€ë ¨,ë¬¸ì˜-í•™ìŠµë³€ê²½(ì˜¤í”„ë¼ì¸),í•´ì§€,ì·¨ì†Œ,í™˜ë¶ˆ,ë¬¸ì˜,ë³€ê²½,,,,
ì·¨ì†Œ/í™˜ë¶ˆê´€ë ¨,ë¬¸ì˜-ì½˜í…ì¸ /ì„œë¹„ìŠ¤,í•´ì§€,ì·¨ì†Œ,í™˜ë¶ˆ,ë¬¸ì˜,ì½˜í…ì¸ ,ì„œë¹„ìŠ¤,,,
ì·¨ì†Œ/í™˜ë¶ˆê´€ë ¨,ë¬¸ì˜-í•™ìŠµì „ìš©ê¸°ê¸°,í•´ì§€,ì·¨ì†Œ,í™˜ë¶ˆ,ë¬¸ì˜,ê¸°ê¸°,,,,
ì·¨ì†Œ/í™˜ë¶ˆê´€ë ¨,ë¬¸ì˜-íš¨ê³¼ì—†ìŒ,í•´ì§€,ì·¨ì†Œ,í™˜ë¶ˆ,ë¬¸ì˜,íš¨ê³¼,,,,
ì·¨ì†Œ/í™˜ë¶ˆê´€ë ¨,ë¬¸ì˜-ê´€ë¦¬(ìê¸°ì£¼ë„),í•´ì§€,ì·¨ì†Œ,í™˜ë¶ˆ,ë¬¸ì˜,ê´€ë¦¬,ìê¸°ì£¼ë„,,,
ì·¨ì†Œ/í™˜ë¶ˆê´€ë ¨,ë¬¸ì˜-ê¸°íƒ€,í•´ì§€,ì·¨ì†Œ,í™˜ë¶ˆ,ë¬¸ì˜,,,,,
ì·¨ì†Œ/í™˜ë¶ˆê´€ë ¨,ìš”ì²­-í•™ìŠµê±°ë¶€/ì‹œê°„ë¶€ì¡±,í•´ì§€,ì·¨ì†Œ,í™˜ë¶ˆ,ìš”ì²­,ê±°ë¶€,ì‹œê°„,,,
ì·¨ì†Œ/í™˜ë¶ˆê´€ë ¨,ìš”ì²­-ê°œì¸ì‚¬ì •,í•´ì§€,ì·¨ì†Œ,í™˜ë¶ˆ,ìš”ì²­,ì‚¬ì •,,,,
ì·¨ì†Œ/í™˜ë¶ˆê´€ë ¨,ìš”ì²­-í•™ìŠµë³€ê²½(ì˜¨ë¼ì¸),í•´ì§€,ì·¨ì†Œ,í™˜ë¶ˆ,ìš”ì²­,ë³€ê²½,,,,
ì·¨ì†Œ/í™˜ë¶ˆê´€ë ¨,ìš”ì²­-í•™ìŠµë³€ê²½(ì˜¤í”„ë¼ì¸),í•´ì§€,ì·¨ì†Œ,í™˜ë¶ˆ,ìš”ì²­,ë³€ê²½,,,,
ì·¨ì†Œ/í™˜ë¶ˆê´€ë ¨,ìš”ì²­-ì½˜í…ì¸ /ì„œë¹„ìŠ¤,í•´ì§€,ì·¨ì†Œ,í™˜ë¶ˆ,ìš”ì²­,ì½˜í…ì¸ ,ì„œë¹„ìŠ¤,,,
ì·¨ì†Œ/í™˜ë¶ˆê´€ë ¨,ìš”ì²­-í•™ìŠµì „ìš©ê¸°ê¸°,í•´ì§€,ì·¨ì†Œ,í™˜ë¶ˆ,ìš”ì²­,ê¸°ê¸°,,,,
ì·¨ì†Œ/í™˜ë¶ˆê´€ë ¨,ìš”ì²­-íš¨ê³¼ì—†ìŒ,í•´ì§€,ì·¨ì†Œ,í™˜ë¶ˆ,ìš”ì²­,íš¨ê³¼,,,,
ì·¨ì†Œ/í™˜ë¶ˆê´€ë ¨,ìš”ì²­-ê´€ë¦¬(ìê¸°ì£¼ë„),í•´ì§€,ì·¨ì†Œ,í™˜ë¶ˆ,ìš”ì²­,ìê¸°ì£¼ë„,,,,
ì·¨ì†Œ/í™˜ë¶ˆê´€ë ¨,ìš”ì²­-ê¸°íƒ€,í•´ì§€,ì·¨ì†Œ,í™˜ë¶ˆ,ìš”ì²­,,,,,
ì·¨ì†Œ/í™˜ë¶ˆê´€ë ¨,ë¬¸ì˜-í•´ì§€ì ˆì°¨/ê¸ˆì•¡,í•´ì§€,ì·¨ì†Œ,í™˜ë¶ˆ,ë¬¸ì˜,í•´ì§€,ê¸ˆì•¡,ë¹„ìš©,,
ì„œë¹„ìŠ¤ê´€ë ¨,ë°€í¬Të‚˜ê°€ê¸°,ë°€í¬T,ë°€í¬í‹°,ë‚˜ê°€ê¸°,,,,,
ì„œë¹„ìŠ¤ê´€ë ¨,í•™ìŠµê´€ë ¨,í•™ìŠµ,ë¬¸ì˜,ì•ˆë‚´,,,,,
ì„œë¹„ìŠ¤ê´€ë ¨,í•™ìŠµê¸°ê°„,í•™ìŠµ,ë¬¸ì˜,ë§Œë£Œ,ê¸°ê°„,ì•½ì •,,,
ì„œë¹„ìŠ¤ê´€ë ¨,ì¿ í°ì¸ì¦ë¬¸ì˜,ì¿ í°,ì§€ë‹ˆë§ˆì¼“,í¬ì¸íŠ¸,ìƒí’ˆê¶Œ,,,,
ì„œë¹„ìŠ¤ê´€ë ¨,ì‰¬ëŠ”ì‹œê°„ë°ë§ˆì¼“Të¬¸ì˜,ì‰¬ëŠ”ì‹œê°„,ì§€ë‹ˆë§ˆì¼“,ê°„ì‹íƒ€ì„,ê¸°í”„í‹°ì½˜,ì»µ,CUP,,,
ì„œë¹„ìŠ¤ê´€ë ¨,ì»¨í…ì¸ ì˜¤ë¥˜,ì»¨í…ì¸ ,ì½˜í…ì¸ ,ì˜¤ë¥˜,ì—ëŸ¬,,,,
ì„œë¹„ìŠ¤ê´€ë ¨,í”„ë¦¬íŒ¨ìŠ¤,í”„ë¦¬íŒ¨ìŠ¤,í”„ë¦¬íŒ¨ìŠ¤,,,,,,
ì„œë¹„ìŠ¤ê´€ë ¨,ë©”íƒ€ì„œë¹„ìŠ¤,ë§ˆì´ë£¸,ë£¨ë¹„,ì•„ì´í…œ,,,,,
ë¶í´ëŸ½,B ì·¨ì†Œ/í™˜ë¶ˆ ìš”ì²­,ë¶í´ëŸ½,í•´ì§€,í™˜ë¶ˆ,,,,
ë¶í´ëŸ½,B ë§›ë³´ê¸°ë¬¸ì˜,ë¶í´ëŸ½,ì²´í—˜,,,,,,
ë¶í´ëŸ½,B ìƒí’ˆë¬¸ì˜,ë¶í´ëŸ½,ê°€ì…,ìƒí’ˆ,,,,
ë¶í´ëŸ½,B í‹°ìŠ¤í‘¼,ë¶í´ëŸ½,í‹°ìŠ¤í‘¼,,,,,,
ë¶í´ëŸ½,B í•™ìŠµê´€ë ¨,ë¶í´ëŸ½,í•™ìŠµ,ë¬¸ì˜,,,,
ë¶í´ëŸ½,B í•™ìŠµê¸°ê°„,ë¶í´ëŸ½,ê¸°ê°„,ì•½ì •,,,,
ë¶í´ëŸ½,B ì‰¬ëŠ”ì‹œê°„ë¬¸ì˜,ë¶í´ëŸ½,ì‰¬ëŠ”ì‹œê°„,,,,,,
ë¶í´ëŸ½,B ì±…ë†€ì´í„°ë¬¸ì˜,ë¶í´ëŸ½,ì±…ë†€ì´í„°,,,,,,
ë¶í´ëŸ½,B ì»¨í…ì¸ ì˜¤ë¥˜,ë¶í´ëŸ½,ì½˜í…ì¸ ,ì˜¤ë¥˜,ì—ëŸ¬,,,,
ê°€ì…/ì²´í—˜ê´€ë ¨,ìƒí’ˆë°ê°€ì…ë¬¸ì˜,ì²´í—˜,ê°€ì…,ë¬¸ì˜,ìƒë‹´,,,,
ê°€ì…/ì²´í—˜ê´€ë ¨,ë¬´ë£Œì²´í—˜ë¬¸ì˜,ì²´í—˜,ë¬´ë£Œì²´í—˜,,,,,,
ê°€ì…/ì²´í—˜ê´€ë ¨,ë¬´ë£Œì²´í—˜ì·¨ì†Œìš”ì²­,ì²´í—˜,ì·¨ì†Œ,ìš”ì²­,,,,,`;

        const parsedData = ìƒë‹´ìœ í˜•ë°ì´í„°.split('\n').slice(1).map(line => {
            const parts = line.split(',');
            const allKeywords = parts.slice(2).filter(k => k.trim() !== '');
            return {
                mainType: parts[0],
                subType: parts[1],
                allKeywords: allKeywords
            };
        });

        const totalDocuments = parsedData.length;
        const allUniqueWords = [...new Set(parsedData.flatMap(doc => doc.allKeywords))];
        const documentFrequency = {};
        allUniqueWords.forEach(word => {
            documentFrequency[word] = parsedData.filter(doc => doc.allKeywords.includes(word)).length;
        });

        const idfScores = {};
        allUniqueWords.forEach(word => {
            idfScores[word] = Math.log(totalDocuments / (documentFrequency[word] || 1));
        });

        let isComposing = false;
        
        inputArea.addEventListener('compositionstart', () => { isComposing = true; });
        inputArea.addEventListener('compositionend', () => {
            isComposing = false;
            processInput();
        });
        
        inputArea.addEventListener('keydown', (event) => {
            if (event.key === 'Enter') {
                event.preventDefault();
                const selection = window.getSelection();
                if (selection.rangeCount > 0) {
                    const range = selection.getRangeAt(0);
                    
                    // í˜„ì¬ ì»¤ì„œ ìœ„ì¹˜ì— ê°œí–‰ ë¬¸ì ì‚½ì…
                    const textNode = document.createTextNode('\n');
                    range.deleteContents();
                    range.insertNode(textNode);
                    
                    // ì»¤ì„œë¥¼ ìƒˆë¡œ ì‚½ì…ëœ ê°œí–‰ ë¬¸ì ë’¤ë¡œ ì´ë™
                    const newRange = document.createRange();
                    newRange.setStartAfter(textNode);
                    newRange.collapse(true);
                    selection.removeAllRanges();
                    selection.addRange(newRange);
                }
                
                processInput();
            }
        });
        
        inputArea.addEventListener('input', () => {
            if (!isComposing) {
                processInput();
            }
        });

        function processInput() {
            highlightKeywords();
            recommendType();
            checkPlaceholder();
        }

        function highlightKeywords() {
            const currentSelection = window.getSelection();
            const currentRange = currentSelection.rangeCount > 0 ? currentSelection.getRangeAt(0) : null;
            const currentOffset = currentRange ? getCaretCharacterOffsetWithin(inputArea) : null;

            const complaintSpans = inputArea.querySelectorAll('span.highlight-complaint');
            complaintSpans.forEach(span => {
                const parent = span.parentNode;
                const textNode = document.createTextNode(span.textContent);
                parent.replaceChild(textNode, span);
                parent.normalize();
            });

            let keywordCounts = {};
            let totalCount = 0;
            const regex = new RegExp(`(${complaintKeywords.join('|')})`, 'gi');
            
            const treeWalker = document.createTreeWalker(inputArea, NodeFilter.SHOW_TEXT, null, false);
            let node;
            
            while ((node = treeWalker.nextNode())) {
                const text = node.nodeValue;
                const matches = [...text.matchAll(regex)];
                
                if (matches.length > 0) {
                    let lastIndex = 0;
                    const fragment = document.createDocumentFragment();
                    matches.forEach(match => {
                        const keyword = match[0];
                        const index = match.index;
                        
                        const textBefore = text.substring(lastIndex, index);
                        if (textBefore) fragment.appendChild(document.createTextNode(textBefore));
                        
                        const span = document.createElement('span');
                        span.className = 'highlight-complaint';
                        span.style.color = 'red';
                        span.textContent = keyword;
                        fragment.appendChild(span);

                        lastIndex = index + keyword.length;
                        keywordCounts[keyword] = (keywordCounts[keyword] || 0) + 1;
                        totalCount++;
                    });
                    
                    const textAfter = text.substring(lastIndex);
                    if (textAfter) fragment.appendChild(document.createTextNode(textAfter));
                    
                    node.parentNode.replaceChild(fragment, node);
                }
            }
            
            if (currentRange) {
                setCaretPosition(inputArea, currentOffset);
            }

            if (totalCount > 0) {
                updateUIForComplaintState(keywordCounts, totalCount);
            } else {
                updateUIForNormalState();
            }
        }

        function getCaretCharacterOffsetWithin(element) {
            let caretOffset = 0;
            const doc = element.ownerDocument || element.document;
            const win = doc.defaultView || doc.parentWindow;
            const sel = win.getSelection();
            if (sel.rangeCount > 0) {
                const range = sel.getRangeAt(0);
                const preCaretRange = range.cloneRange();
                preCaretRange.selectNodeContents(element);
                preCaretRange.setEnd(range.endContainer, range.endOffset);
                caretOffset = preCaretRange.toString().length;
            }
            return caretOffset;
        }

        function setCaretPosition(element, offset) {
            const doc = element.ownerDocument || element.document;
            const win = doc.defaultView || doc.parentWindow;
            const sel = win.getSelection();
            let currentOffset = 0;
            let found = false;
            
            function traverse(node) {
                if (found) return;
                
                if (node.nodeType === Node.TEXT_NODE) {
                    const nextOffset = currentOffset + node.length;
                    if (offset <= nextOffset) {
                        const range = doc.createRange();
                        range.setStart(node, offset - currentOffset);
                        range.collapse(true);
                        sel.removeAllRanges();
                        sel.addRange(range);
                        found = true;
                    }
                    currentOffset = nextOffset;
                } else {
                    for (let i = 0; i < node.childNodes.length; i++) {
                        traverse(node.childNodes[i]);
                        if (found) break;
                    }
                }
            }
            
            traverse(element);
        }

        function updateUIForComplaintState(keywordCounts, totalCount) {
            inputArea.style.border = '1px solid red';
            resultBox.className = 'result-box complaint';
            resultBox.innerText = 'ë¶ˆë§Œ ì˜ì‹¬ í‘œí˜„ì´ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤.';
            resultBox.style.display = 'block';

            keywordsBox.style.display = 'flex';
            keywordsTitle.innerHTML = `VOC í‚¤ì›Œë“œ (${totalCount}ê°œ)`;
            keywordList.innerHTML = '';
            
            const foundKeywords = Object.keys(keywordCounts);
            foundKeywords.forEach(k => {
                const span = document.createElement('span');
                span.className = 'keyword';
                span.innerText = `${k}(${keywordCounts[k]})`;
                span.addEventListener('click', () => {
                    keywordDescBox.innerText = `ã€Œ${k}ã€: ${keywordDescriptions[k] || 'ì„¤ëª… ì—†ìŒ'}`;
                    keywordDescBox.style.display = 'block';
                });
                keywordList.appendChild(span);
            });
            keywordDescBox.style.display = 'none';
        }
        
        function updateUIForNormalState() {
            inputArea.style.border = '1px solid #ccc';
            resultBox.className = 'result-box normal';
            resultBox.innerText = 'ë¶ˆë§Œ í‘œí˜„ì´ ê°ì§€ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.';
            resultBox.style.display = 'block';

            keywordsBox.style.display = 'none';
            keywordList.innerHTML = '';
            keywordDescBox.style.display = 'none';

            if (inputArea.textContent.trim().length === 0) {
                initialMessage.style.display = 'block';
            } else {
                initialMessage.style.display = 'none';
            }
        }

        function recommendType() {
            const text = inputArea.textContent.trim();
            const words = text.split(/\s+/).filter(w => w.length > 0);
            
            initialMessage.style.display = (text.length === 0) ? 'block' : 'none';

            if (text.length === 0) {
                recommendationList.innerHTML = `<div class="initial-message">ë‚´ìš©ì„ ì…ë ¥í•˜ë©´<br>ì¶”ì²œ ìœ í˜•ì´ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.</div>`;
                return;
            }
            
            let scores = [];
            const tokenizedText = words.map(word => word.replace(/[,.?!]/g, ''));
            const termFrequencyInInput = {};
            tokenizedText.forEach(word => {
                termFrequencyInInput[word] = (termFrequencyInInput[word] || 0) + 1;
            });
            
            parsedData.forEach(type => {
                let totalScore = 0;
                let matchedKeywords = [];
                type.allKeywords.forEach(keyword => {
                    const cleanKeyword = keyword.replace(/ /g, '');
                    if (text.includes(cleanKeyword)) {
                        const tf = termFrequencyInInput[cleanKeyword] || 0;
                        const idf = idfScores[keyword] || 0;
                        const tfidfScore = tf * idf;
                        totalScore += tfidfScore;
                        matchedKeywords.push(keyword);
                    }
                });

                if (matchedKeywords.length > 1) {
                    const sortedMatched = matchedKeywords.sort((a, b) => (idfScores[b] || 0) - (idfScores[a] || 0));
                    const highestScoringKeyword = sortedMatched[0];
                    const highestScoringIndex = tokenizedText.indexOf(highestScoringKeyword);
                    
                    if (highestScoringIndex !== -1) {
                        for (let i = 1; i < sortedMatched.length; i++) {
                            const otherKeyword = sortedMatched[i];
                            const otherIndex = tokenizedText.indexOf(otherKeyword);
                            const distance = Math.abs(highestScoringIndex - otherIndex);
                            if (distance > 0 && distance <= 5) {
                                totalScore += 10;
                            }
                        }
                    }
                }

                if (matchedKeywords.length > 0) {
                    scores.push({
                        type: `${type.mainType}-${type.subType}`,
                        score: totalScore,
                        matchedKeywords: matchedKeywords
                    });
                }
            });
            
            scores.sort((a, b) => b.score - a.score);
            const top3 = scores.slice(0, 3);

            recommendationList.innerHTML = '';
            if (top3.length > 0) {
                top3.forEach(item => {
                    const div = document.createElement('div');
                    div.className = 'recommendation-item';
                    div.innerHTML = `
                        <div class="recommendation-item-line"></div>
                        <div class="recommendation-item-content">
                            <div class="recommendation-title">${item.type}</div>
                            <div class="match-info">
                                ì ìˆ˜: <strong>${item.score.toFixed(1)}ì </strong><br>
                                ì¼ì¹˜ í‚¤ì›Œë“œ: ${item.matchedKeywords.join(', ')}
                            </div>
                        </div>
                    `;
                    recommendationList.appendChild(div);
                });
            } else {
                recommendationList.innerHTML = `<div class="initial-message">ì¼ì¹˜í•˜ëŠ” ìœ í˜•ì´ ì—†ìŠµë‹ˆë‹¤.</div>`;
            }
        }

        function checkPlaceholder() {
            if (inputArea.textContent.trim() === '') {
                inputArea.setAttribute('data-placeholder', inputArea.getAttribute('placeholder'));
            } else {
                inputArea.removeAttribute('data-placeholder');
            }
        }
        
        const originalFetch = window.fetch;
        window.fetch = function(...args) {
            securityBanner.textContent = "ğŸš¨ ë³´ì•ˆ ê²½ê³ : ì™¸ë¶€ë¡œ ë°ì´í„° ì „ì†¡ ì‹œë„ ê°ì§€ë¨!";
            securityBanner.style.backgroundColor = "red";
            securityBanner.style.color = "white";
            return originalFetch.apply(this, args);
        };
        const originalXHR = window.XMLHttpRequest;
        function MonitorXHR() {
            const xhr = new originalXHR();
            xhr.addEventListener('loadstart', () => {
                securityBanner.textContent = "ğŸš¨ ë³´ì•ˆ ê²½ê³ : ì™¸ë¶€ë¡œ ë°ì´í„° ì „ì†¡ ì‹œë„ ê°ì§€ë¨!";
                securityBanner.style.backgroundColor = "red";
                securityBanner.style.color = "white";
            });
            return xhr;
        }
        window.XMLHttpRequest = MonitorXHR;

        let deferredPrompt;
        const installPopup = document.getElementById('installPopup');
        const confirmInstall = document.getElementById('confirmInstall');
        const cancelInstall = document.getElementById('cancelInstall');

        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            installPopup.style.display = 'block'; 
        });

        window.addEventListener('appinstalled', () => {
            installPopup.style.display = 'none'; 
        });

        confirmInstall.addEventListener('click', () => {
            installPopup.style.display = 'none';
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then(choiceResult => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('ì•± ì„¤ì¹˜ ì™„ë£Œ');
                    } else {
                        console.log('ì‚¬ìš©ìê°€ ì„¤ì¹˜ë¥¼ ì·¨ì†Œí•¨');
                    }
                    deferredPrompt = null;
                });
            } else {
                alert('ì„¤ì¹˜ë¥¼ ì§€ì›í•˜ì§€ ì•ŠëŠ” í™˜ê²½ì…ë‹ˆë‹¤.');
            }
        });

        cancelInstall.addEventListener('click', () => {
            installPopup.style.display = 'none';
            deferredPrompt = null;
        });

        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('service-worker.js')
                .then(() => console.log('âœ… Service Worker ë“±ë¡ ì™„ë£Œ'))
                .catch(err => console.error('âŒ Service Worker ë“±ë¡ ì‹¤íŒ¨:', err));
        }

    </script>
</body>
</html>